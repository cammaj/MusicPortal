{% extends 'base.html' %}
{% block content %}
<div class="section-header">
  <div style="display: flex; align-items: center; gap: 1rem;">
    {% if artist['profile_image'] %}
    <img src="{{ url_for('static', filename='uploads/' ~ artist['profile_image']) }}" alt="{{ artist['username'] }}" style="width: 64px; height: 64px; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.1);">
    {% endif %}
    <div>
      <p class="eyebrow">Artist</p>
      <h2>{{ artist['username'] }} — All Concerts</h2>
    </div>
  </div>
  <a class="pill" href="{{ url_for('search_concerts') }}">Back to Discover</a>
</div>

<div class="card-grid">
  {% for concert in concerts %}
  <div class="concert-card {% if concert['image_filename'] %}has-image{% endif %} {% if concert['archived'] %}archived{% endif %}"
       {% if concert['image_filename'] %}
       style="background-image: linear-gradient(160deg, rgba(12,15,35,0.35), rgba(12,15,35,0.75)), url('{{ url_for('static', filename='uploads/' ~ concert['image_filename']) }}'); background-size: cover; background-position: center; cursor: pointer;"
       {% else %}
       style="cursor: pointer;"
       {% endif %}
       onclick="location.href='{{ url_for('view_concert', concert_id=concert['id']) }}';">
    <div class="concert-meta" style="display: flex; justify-content: space-between; align-items: flex-start; width: 100%;">
      <div style="display: flex; gap: 0.5rem;">
        <span class="pill">{{ concert['status'] }}</span>
        <span class="pill soft">Price: {{ concert['cost'] }}</span>
      </div>
      {% if g.user and g.user['role'] == 'fan' %}
        {% if concert['id'] in selected_ids %}
        <form method="post" action="{{ url_for('remove_selected', concert_id=concert['id']) }}" onclick="event.stopPropagation();">
          <button class="fav-btn active" type="submit" title="Remove from favorites">♥</button>
        </form>
        {% else %}
        <form method="post" action="{{ url_for('add_selected', concert_id=concert['id']) }}" onclick="event.stopPropagation();">
          <button class="fav-btn" type="submit" title="Add to favorites">♡</button>
        </form>
        {% endif %}
      {% endif %}
    </div>
    <h3>{{ concert['band_name'] }}</h3>
    <p class="muted">{{ concert['venue'] }}</p>
    <p class="date">{{ concert['concert_datetime'].replace('T', ' ') }}</p>
  </div>
  {% endfor %}
</div>
{% if not concerts %}
  <div class="empty">No concerts yet for this artist.</div>
{% endif %}
{% endblock %}
